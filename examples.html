<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/xdoc/examples.xml.vm at 29 Apr 2025
 | Rendered using Apache Maven Fluido Skin 2.0.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <meta name="author" content="The MyBatis Team" />
    <title>Examples – MyBatis Migrations Maven plugin</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.1.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"><div id="bannerRight"><h1><a href="https://blog.mybatis.org/"><img class="class java.lang.Object" src="../images/mybatis-logo.png" alt="MyBatis logo" /> MyBatis</a></h1></div></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 11 Aug 2024<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.2.1-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Reference Documentation</li>
    <li><a href="index.html">Introduction</a></li>
    <li><a href="plugin-info.html">Goals</a></li>
    <li><a href="usage.html">Usage</a></li>
    <li class="active"><a>Examples</a></li>
    <li><a href="faq.html">FAQ</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">


  
  <section><a id="Intregrate_migrate_in_Maven_life_cycle"></a>
<h1>Intregrate migrate in Maven life cycle</h1>
        
<p>
            It can be useful integrate Migration steps into a build life cycle, i.e. integrating the database schema
            creation into a CI build lifecycle.</p>

            
<pre class="prettyprint"><code>&lt;plugins&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
    &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.2.1-SNAPSHOT&lt;/version&gt;
    &lt;dependencies&gt;
      [ add your jdbc driver depencency ]
    &lt;/dependencies&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;id&gt;apply-all-pending-migration&lt;/id&gt;
        &lt;phase&gt;process-test-resources&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;up&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;configuration&gt;
           &lt;repository&gt; [migration repository path] &lt;/repository&gt;
        &lt;/configuration&gt;
      &lt;/execution&gt;
   &lt;/executions&gt;
  &lt;/plugin&gt;
&lt;plugins&gt;</code></pre>

            
<p>If your project uses the sub-modules you can set your parent pom in this way:</p>

            
<pre class="prettyprint"><code>&lt;build&gt;
  &lt;pluginManagement&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
        &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.2.1-SNAPSHOT&lt;/version&gt;
        &lt;dependencies&gt;
          [ add your jdbc driver depencency ]
        &lt;/dependencies&gt;
        &lt;configuration&gt;
          &lt;skip&gt;true&lt;/skip&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/pluginManagement&gt;

  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
      &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>

            
<p>Then, in submodules:</p>

            
<pre class="prettyprint"><code>&lt;plugins&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
    &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
      &lt;repository&gt; [migration repository path] &lt;/repository&gt;
      &lt;skip&gt;false&lt;/skip&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;id&gt;migration-chack&lt;/id&gt;
        &lt;phase&gt;test&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;check&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;inherited&gt;false&lt;/inherited&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
  &lt;/plugin&gt;

&lt;plugins&gt;</code></pre>

    </section>

    <section><a id="Use_Migration_commands"></a>
<h1>Use Migration commands</h1>
        
<p>
            Migration plugin aims to help you to administer your database via MyBatis Schema Migration, so, i.e, you can
            use this plugin to create new migration scripts and to apply the pending scripts to your database.
            The following example will show the common commands to create and administer your database.
        </p>
        
<p>
            First of all you have to initialize your migration repository:</p>

            
<pre>mvn migration:init -Dmigration.path=/path/to/repository</pre>

            
<p>This command inizializes the standard migration repository into <code>/path/to/repository</code> folder.</p>

            
<p>After you have to modify and customize your enviroment: edit the file
            <code>/path/to/repository/enviroments/development.properties</code> and set the database coordinte.
            So you can apply the first migration to the database:</p>

            
<pre>mvn migration:up -Dmigration.path=/path/to/repository</pre>

            
<p>Now it is possible to create the new script:</p>

            
<pre>mvn migration:new -Dmigration.path=/path/to/repository -Dmigration.description=my_second_schema_migration</pre>

            
<p>the command creates a new empty sql file into the folder <code>/path/to/repository/scripts</code>
            like this:</p>

            
<pre>--// First migration.
-- Migration SQL that makes the change goes here.

--//@UNDO
-- SQL to undo the change goes here.</pre>

            
<p>now you can check the current status of your database by executing this the status goal:</p>

            
<pre>mvn migration:status -Dmigration.path=/path/to/repository

[INFO] Executing  Apache Migration StatusCommand
[INFO] ID             Applied At             Description
[INFO] ================================================================================
[INFO] 20100400000001    2010-04-24 22:51:16    create changelog
[INFO] 20100400000002    2010-04-24 22:51:17    first migration
[INFO] 20100400000003    ...pending...          my second schema migration
[INFO]</pre>

            
<p>finally you can apply the last migration pending script:</p>

            
<pre>mvn migration:up -Dmigration.path=/path/to/repository

mvn migration:status -Dmigration.path=/path/to/repository

[INFO] Executing  Apache Migration StatusCommand
[INFO] ID             Applied At             Description
[INFO] ================================================================================
[INFO] 20100400000001    2010-04-24 22:51:16    create changelog
[INFO] 20100400000002    2010-04-24 22:51:17    first migration
[INFO] 20100400000003    2010-04-24 23:14:07    my second schema migration
[INFO]</pre>

    </section>

    <section><a id="Migration_plugin_report"></a>
<h1>Migration plugin report</h1>
      <img src="./images/migration-mvn.png" alt="Migration plugin report" />
    </section>

    <section><a id="Migration_plugin_report_with_warnings"></a>
<h1>Migration plugin report with warnings</h1>
      <img src="./images/migration-mvn-warning.png" alt="Migration plugin report with warnings" />
    </section>



        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2010–2025
<a href="https://www.mybatis.org/">MyBatis.org</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
